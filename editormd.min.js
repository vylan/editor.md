;(function(a){"use strict";if(typeof require==="function"&&typeof exports==="object"&&typeof module==="object"){module.exports=a}else if(typeof define==="function"){if(define.amd){}else{define(["jquery"],a)}}else{window.editormd=a()}}(function(){"use strict";var $=(typeof(jQuery)!=="undefined")?jQuery:Zepto;if(typeof($)==="undefined"){return}var E=function(a,b,c){return new E.fn.init(a,b,c)};E.title=E.$name="Editor.md";E.version="1.5.0";E.homePage="https://pandao.github.io/editor.md/";E.classPrefix="editormd-";E.toolbarModes={full:["undo","redo","|","bold","del","italic","quote","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","preformatted-text","code-block","table","datetime","html-entities","pagebreak","|","goto-line","watch","preview","fullscreen","clear","search","|","help"],simple:["undo","redo","|","bold","del","italic","quote","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","watch","preview","fullscreen","|","help","info"],mini:["undo","redo","|","watch","preview","|","help","info"]};E.defaults={mode:"gfm",name:"",value:"",theme:"",editorTheme:"default",previewTheme:"",markdown:"",appendMarkdown:"",width:"100%",height:"100%",path:"./lib/",pluginPath:"",delay:300,autoLoadModules:true,watch:true,placeholder:"Enjoy Markdown! coding now...",gotoLine:true,codeFold:false,autoHeight:false,autoFocus:true,autoCloseTags:true,searchReplace:true,syncScrolling:true,readOnly:false,tabSize:4,indentUnit:4,lineNumbers:true,lineWrapping:true,autoCloseBrackets:true,showTrailingSpace:true,matchBrackets:true,indentWithTabs:true,styleSelectedText:true,matchWordHighlight:true,styleActiveLine:true,dialogLockScreen:true,dialogShowMask:true,dialogDraggable:true,dialogMaskBgColor:"#fff",dialogMaskOpacity:0.1,fontSize:"13px",saveHTMLToTextarea:false,disabledKeyMaps:[],onload:function(){},onresize:function(){},onchange:function(){},onwatch:null,onunwatch:null,onpreviewing:function(){},onpreviewed:function(){},onfullscreen:function(){},onfullscreenExit:function(){},onscroll:function(){},onpreviewscroll:function(){},imageUpload:false,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"",crossDomainUpload:false,uploadCallbackURL:"",toc:true,tocm:false,tocTitle:"",tocDropdown:false,tocContainer:"",tocStartLevel:1,htmlDecode:false,pageBreak:true,atLink:true,emailLink:true,taskList:false,emoji:false,tex:false,flowChart:false,sequenceDiagram:false,previewCodeHighlight:true,toolbar:true,toolbarAutoFixed:true,toolbarIcons:"full",toolbarTitles:{},toolbarHandlers:{ucwords:function(){return E.toolbarHandlers.ucwords},lowercase:function(){return E.toolbarHandlers.lowercase}},toolbarCustomIcons:{lowercase:"<a href=\"javascript:;\" title=\"Lowercase\" unselectable=\"on\"><i class=\"fa\" name=\"lowercase\" style=\"margin-top: -10px;\">a</i></a>","ucwords":"<a href=\"javascript:;\" title=\"ucwords\" unselectable=\"on\"><i class=\"fa\" name=\"ucwords\" style=\"margin-top: -3px;\">Aa</i></a>"},toolbarIconsClass:{undo:"fa-undo",redo:"fa-repeat",bold:"fa-bold",del:"fa-strikethrough",italic:"fa-italic",quote:"fa-quote-left",uppercase:"fa-font",h1:E.classPrefix+"bold",h2:E.classPrefix+"bold",h3:E.classPrefix+"bold",h4:E.classPrefix+"bold",h5:E.classPrefix+"bold",h6:E.classPrefix+"bold","list-ul":"fa-list-ul","list-ol":"fa-list-ol",hr:"fa-minus",link:"fa-link","reference-link":"fa-anchor",image:"fa-picture-o",code:"fa-code","preformatted-text":"fa-file-code-o","code-block":"fa-file-code-o",table:"fa-table",datetime:"fa-clock-o",emoji:"fa-smile-o","html-entities":"fa-copyright",pagebreak:"fa-newspaper-o","goto-line":"fa-terminal",watch:"fa-eye-slash",unwatch:"fa-eye",preview:"fa-desktop",search:"fa-search",fullscreen:"fa-arrows-alt",clear:"fa-eraser",help:"fa-question-circle",info:"fa-info-circle"},toolbarIconTexts:{},lang:{name:"zh-cn",description:"开源在线Markdown编辑器<br/>Open source online Markdown editor.",tocTitle:"目录",toolbar:{undo:"撤销（Ctrl+Z）",redo:"重做（Ctrl+Y）",bold:"粗体",del:"删除线",italic:"斜体",quote:"引用",ucwords:"将每个单词首字母转成大写",uppercase:"将所选转换成大写",lowercase:"将所选转换成小写",h1:"标题1",h2:"标题2",h3:"标题3",h4:"标题4",h5:"标题5",h6:"标题6","list-ul":"无序列表","list-ol":"有序列表",hr:"横线",link:"链接","reference-link":"引用链接",image:"添加图片",code:"行内代码","preformatted-text":"预格式文本 / 代码块（缩进风格）","code-block":"代码块（多语言风格）",table:"添加表格",datetime:"日期时间",emoji:"Emoji表情","html-entities":"HTML实体字符",pagebreak:"插入分页符","goto-line":"跳转到行",watch:"关闭实时预览",unwatch:"开启实时预览",preview:"全窗口预览HTML（按 Shift + ESC还原）",fullscreen:"全屏（按ESC还原）",clear:"清空",search:"搜索",help:"使用帮助",info:"关于"+E.title},buttons:{enter:"确定",cancel:"取消",close:"关闭"},dialog:{link:{title:"添加链接",url:"链接地址",urlTitle:"链接标题",urlEmpty:"错误：请填写链接地址。"},referenceLink:{title:"添加引用链接",name:"引用名称",url:"链接地址",urlId:"链接ID",urlTitle:"链接标题",nameEmpty:"错误：引用链接的名称不能为空。",idEmpty:"错误：请填写引用链接的ID。",urlEmpty:"错误：请填写引用链接的URL地址。"},image:{title:"添加图片",url:"图片地址",link:"图片链接",alt:"图片描述",uploadButton:"本地上传",imageURLEmpty:"错误：图片地址不能为空。",uploadFileEmpty:"错误：上传的图片不能为空。",formatNotAllowed:"错误：只允许上传图片文件，允许上传的图片文件格式有："},preformattedText:{title:"添加预格式文本或代码块",emptyAlert:"错误：请填写预格式文本或代码的内容。"},codeBlock:{title:"添加代码块",selectLabel:"代码语言：",selectDefaultText:"请选择代码语言",otherLanguage:"其他语言",unselectedLanguageAlert:"错误：请选择代码所属的语言类型。",codeEmptyAlert:"错误：请填写代码内容。"},htmlEntities:{title:"HTML 实体字符"},help:{title:"使用帮助"}}}};E.classNames={tex:E.classPrefix+"tex"};E.dialogZindex=99999;E.$katex=null;E.$marked=null;E.$CodeMirror=null;E.$prettyPrint=null;var F,flowchartTimer,sourceLoaded=[];E.prototype=E.fn={state:{watching:false,loaded:false,preview:false,fullscreen:false},init:function(a,b,c){c=c||{};if(typeof a==="object"){c=a}var d=this;var e=this.classPrefix=E.classPrefix;var f=this.settings=$.extend(true,E.defaults,c);a=(typeof a==="object")?f.id:a;var g=this.editor=b;console.log(g)this.id=a;this.lang=f.lang;var h=this.classNames={textarea:{html:e+"html-textarea",markdown:e+"markdown-textarea"}};f.pluginPath=(f.pluginPath==="")?f.path+"../plugins/":f.pluginPath;this.state.watching=(f.watch)?true:false;if(!g.hasClass("editormd")){g.addClass("editormd")}g.css({width:(typeof f.width==="number")?f.width+"px":f.width,height:(typeof f.height==="number")?f.height+"px":f.height});if(f.autoHeight){g.css("height","auto")}var i=this.markdownTextarea=g.children("textarea");if(i.length<1){g.append("<textarea></textarea>");i=this.markdownTextarea=g.children("textarea")}i.addClass(h.textarea.markdown).attr("placeholder",f.placeholder);if(typeof i.attr("name")==="undefined"||i.attr("name")===""){i.attr("name",(f.name!=="")?f.name:a+"-markdown-doc")}var j=[(!f.readOnly)?"<a href=\"javascript:;\" class=\"icon-close "+e+"preview-close-btn\"></a>":"",((f.saveHTMLToTextarea)?"<textarea class=\""+h.textarea.html+"\" name=\""+a+"-html-code\"></textarea>":""),"<div class=\""+e+"preview\"><div class=\"markdown-body "+e+"preview-container\"></div></div>","<div class=\""+e+"container-mask\" style=\"display:block;\"></div>","<div class=\""+e+"mask\"></div>"].join("\n");g.append(j).addClass(e+"vertical");if(f.theme!==""){g.addClass(e+"theme-"+f.theme)}this.mask=g.children("."+e+"mask");this.containerMask=g.children("."+e+"container-mask");if(f.markdown!==""){i.val(f.markdown)}if(f.appendMarkdown!==""){i.val(i.val()+f.appendMarkdown)}this.htmlTextarea=g.children("."+h.textarea.html);this.preview=g.children("."+e+"preview");this.previewContainer=this.preview.children("."+e+"preview-container");if(f.previewTheme!==""){this.preview.addClass(e+"preview-theme-"+f.previewTheme)}if(typeof define==="function"&&define.amd){if(typeof katex!=="undefined"){E.$katex=katex}if(f.searchReplace&&!f.readOnly){E.loadCSS(f.path+"codemirror/addon/dialog/dialog");E.loadCSS(f.path+"codemirror/addon/search/matchesonscrollbar")}}if((typeof define==="function"&&define.amd)||!f.autoLoadModules){if(typeof CodeMirror!=="undefined"){E.$CodeMirror=CodeMirror}if(typeof marked!=="undefined"){E.$marked=marked}this.setCodeMirror().setToolbar().loadedDisplay()}else{this.loadQueues()}return this},remove:function(){F=0;this.editor.remove()},loadQueues:function(){var a=this;var b=this.settings;var c=b.path;var d=function(){if(E.isIE8){a.loadedDisplay();return}if(b.flowChart||b.sequenceDiagram){E.loadScript(c+"raphael.min",function(){E.loadScript(c+"underscore.min",function(){if(!b.flowChart&&b.sequenceDiagram){E.loadScript(c+"sequence-diagram.min",function(){a.loadedDisplay()})}else if(b.flowChart&&!b.sequenceDiagram){E.loadScript(c+"flowchart.min",function(){E.loadScript(c+"jquery.flowchart.min",function(){a.loadedDisplay()})})}else if(b.flowChart&&b.sequenceDiagram){E.loadScript(c+"flowchart.min",function(){E.loadScript(c+"jquery.flowchart.min",function(){E.loadScript(c+"sequence-diagram.min",function(){a.loadedDisplay()})})})}})})}else{a.loadedDisplay()}};E.loadCSS(c+"codemirror/codemirror.min");if(b.searchReplace&&!b.readOnly){E.loadCSS(c+"codemirror/addon/dialog/dialog");E.loadCSS(c+"codemirror/addon/search/matchesonscrollbar")}if(b.codeFold){E.loadCSS(c+"codemirror/addon/fold/foldgutter")}E.loadScript(c+"codemirror/codemirror.min",function(){E.$CodeMirror=CodeMirror;E.loadScript(c+"codemirror/modes.min",function(){E.loadScript(c+"codemirror/addons.min",function(){a.setCodeMirror();if(b.mode!=="gfm"&&b.mode!=="markdown"){a.loadedDisplay();return false}a.setToolbar();E.loadScript(c+"marked.min",function(){E.$marked=marked;if(b.previewCodeHighlight){E.loadScript(c+"prettify.min",function(){d()})}else{d()}})})})});return this},setTheme:function(a){var b=this.editor;var c=this.settings.theme;var d=this.classPrefix+"theme-";b.removeClass(d+c).addClass(d+a);this.settings.theme=a;return this},setEditorTheme:function(a){var b=this.settings;b.editorTheme=a;if(a!=="default"){E.loadCSS(b.path+"codemirror/theme/"+b.editorTheme)}this.cm.setOption("theme",a);return this},setCodeMirrorTheme:function(a){this.setEditorTheme(a);return this},setPreviewTheme:function(a){var b=this.preview;var c=this.settings.previewTheme;var d=this.classPrefix+"preview-theme-";b.removeClass(d+c).addClass(d+a);this.settings.previewTheme=a;return this},setCodeMirror:function(){var b=this.settings;var c=this.editor;if(b.editorTheme!=="default"){E.loadCSS(b.path+"codemirror/theme/"+b.editorTheme)}var d={mode:b.mode,theme:b.editorTheme,tabSize:b.tabSize,dragDrop:false,autofocus:b.autoFocus,autoCloseTags:b.autoCloseTags,readOnly:(b.readOnly)?"nocursor":false,indentUnit:b.indentUnit,lineNumbers:b.lineNumbers,lineWrapping:b.lineWrapping,extraKeys:{"Ctrl-Q":function(a){a.foldCode(a.getCursor())}},foldGutter:b.codeFold,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:b.matchBrackets,indentWithTabs:b.indentWithTabs,styleActiveLine:b.styleActiveLine,styleSelectedText:b.styleSelectedText,autoCloseBrackets:b.autoCloseBrackets,showTrailingSpace:b.showTrailingSpace,highlightSelectionMatches:((!b.matchWordHighlight)?false:{showToken:(b.matchWordHighlight==="onselected")?false:/\w/})};this.codeEditor=this.cm=E.$CodeMirror.fromTextArea(this.markdownTextarea[0],d);this.codeMirror=this.cmElement=c.children(".CodeMirror");if(b.value!==""){this.cm.setValue(b.value)}this.codeMirror.css({fontSize:b.fontSize,width:(!b.watch)?"100%":"50%"});if(b.autoHeight){this.codeMirror.css("height","auto");this.cm.setOption("viewportMargin",Infinity)}if(!b.lineNumbers){this.codeMirror.find(".CodeMirror-gutters").css("border-right","none")}return this},getCodeMirrorOption:function(a){return this.cm.getOption(a)},setCodeMirrorOption:function(a,b){this.cm.setOption(a,b);return this},addKeyMap:function(a,b){this.cm.addKeyMap(a,b);return this},removeKeyMap:function(a){this.cm.removeKeyMap(a);return this},gotoLine:function(a){var b=this.settings;if(!b.gotoLine){return this}var c=this.cm;var d=this.editor;var e=c.lineCount();var f=this.preview;if(typeof a==="string"){if(a==="last"){a=e}if(a==="first"){a=1}}if(typeof a!=="number"){alert("Error: The line number must be an integer.");return this}a=parseInt(a)-1;if(a>e){alert("Error: The line number range 1-"+e);return this}c.setCursor({line:a,ch:0});var g=c.getScrollInfo();var h=g.clientHeight;var i=c.charCoords({line:a,ch:0},"local");c.scrollTo(null,(i.top+i.bottom-h)/2);if(b.watch){var j=this.codeMirror.find(".CodeMirror-scroll")[0];var k=$(j).height();var l=j.scrollTop;var m=(l/j.scrollHeight);if(l===0){f.scrollTop(0)}else if(l+k>=j.scrollHeight-16){f.scrollTop(f[0].scrollHeight)}else{f.scrollTop(f[0].scrollHeight*m)}}c.focus();return this},extend:function(){if(typeof arguments[1]!=="undefined"){if(typeof arguments[1]==="function"){arguments[1]=$.proxy(arguments[1],this)}this[arguments[0]]=arguments[1]}if(typeof arguments[0]==="object"&&typeof arguments[0].length==="undefined"){$.extend(true,this,arguments[0])}return this},set:function(a,b){if(typeof b!=="undefined"&&typeof b==="function"){b=$.proxy(b,this)}this[a]=b;return this},config:function(a,b){var c=this.settings;if(typeof a==="object"){c=$.extend(true,c,a)}if(typeof a==="string"){c[a]=b}this.settings=c;this.recreate();return this},on:function(a,b){var c=this.settings;if(typeof c["on"+a]!=="undefined"){c["on"+a]=$.proxy(b,this)}return this},off:function(a){var b=this.settings;if(typeof b["on"+a]!=="undefined"){b["on"+a]=function(){}}return this},showToolbar:function(a){var b=this.settings;if(b.readOnly){return this}if(b.toolbar&&(this.toolbar.length<1||this.toolbar.find("."+this.classPrefix+"menu").html()==="")){this.setToolbar()}b.toolbar=true;this.toolbar.show();this.resize();$.proxy(a||function(){},this)();return this},hideToolbar:function(a){var b=this.settings;b.toolbar=false;this.toolbar.hide();this.resize();$.proxy(a||function(){},this)();return this},setToolbarAutoFixed:function(c){var d=this.state;var e=this.editor;var f=this.toolbar;var g=this.settings;if(typeof c!=="undefined"){g.toolbarAutoFixed=c}var h=function(){var a=$(window);var b=a.scrollTop();if(!g.toolbarAutoFixed){return false}if(b-e.offset().top>10&&b<e.height()){f.css({position:"fixed",width:e.width()+"px",left:(a.width()-e.width())/2+"px"})}else{f.css({position:"absolute",width:"100%",left:0})}};if(!d.fullscreen&&!d.preview&&g.toolbar&&g.toolbarAutoFixed){$(window).bind("scroll",h)}return this},setToolbar:function(){var a=this.settings;if(a.readOnly){return this}var b=this.editor;var c=this.preview;var d=this.classPrefix;var e=this.toolbar=b.children("."+d+"toolbar");if(a.toolbar&&e.length<1){var f="<div class=\""+d+"toolbar\"><div class=\""+d+"toolbar-container\"><ul class=\""+d+"menu\"></ul></div></div>";b.append(f);e=this.toolbar=b.children("."+d+"toolbar")}if(!a.toolbar){e.hide();return this}e.show();var g=(typeof a.toolbarIcons==="function")?a.toolbarIcons():((typeof a.toolbarIcons==="string")?E.toolbarModes[a.toolbarIcons]:a.toolbarIcons);var h=e.find("."+this.classPrefix+"menu"),menu="";var j=false;for(var i=0,len=g.length;i<len;i++){var k=g[i];if(k==="||"){j=true}else if(k==="|"){menu+="<li class=\"divider\" unselectable=\"on\">|</li>"}else{var l=(/h(\d)/.test(k));var m=k;if(k==="watch"&&!a.watch){m="unwatch"}var n=a.lang.toolbar[m];var o=a.toolbarIconTexts[m];var p=a.toolbarIconsClass[m];n=(typeof n==="undefined")?"":n;o=(typeof o==="undefined")?"":o;p=(typeof p==="undefined")?"":p;var q=j?"<li class=\"pull-right\">":"<li>";if(typeof a.toolbarCustomIcons[k]!=="undefined"&&typeof a.toolbarCustomIcons[k]!=="function"){q+=a.toolbarCustomIcons[k]}else{q+="<a href=\"javascript:;\" title=\""+n+"\" unselectable=\"on\">";q+="<i class=\"fa "+p+"\" name=\""+k+"\" unselectable=\"on\">"+((l)?k.toUpperCase():((p==="")?o:""))+"</i>";q+="</a>"}q+="</li>";menu=j?q+menu:menu+q}}h.html(menu);h.find("[title=\"Lowercase\"]").attr("title",a.lang.toolbar.lowercase);h.find("[title=\"ucwords\"]").attr("title",a.lang.toolbar.ucwords);this.setToolbarHandler();this.setToolbarAutoFixed();return this},dialogLockScreen:function(){$.proxy(E.dialogLockScreen,this)();return this},dialogShowMask:function(a){$.proxy(E.dialogShowMask,this)(a);return this},getToolbarHandles:function(a){var b=this.toolbarHandlers=E.toolbarHandlers;return(a&&typeof toolbarIconHandlers[a]!=="undefined")?b[a]:b},setToolbarHandler:function(){var f=this;var g=this.settings;if(!g.toolbar||g.readOnly){return this}var h=this.toolbar;var i=this.cm;var j=this.classPrefix;var k=this.toolbarIcons=h.find("."+j+"menu > li > a");var l=this.getToolbarHandles();k.bind(E.mouseOrTouch("click","touchend"),function(a){var b=$(this).children(".fa");var c=b.attr("name");var d=i.getCursor();var e=i.getSelection();if(c===""){return}f.activeIcon=b;if(typeof l[c]!=="undefined"){$.proxy(l[c],f)(i)}else{if(typeof g.toolbarHandlers[c]!=="undefined"){$.proxy(g.toolbarHandlers[c],f)(i,b,d,e)}}if(c!=="link"&&c!=="reference-link"&&c!=="image"&&c!=="code-block"&&c!=="preformatted-text"&&c!=="watch"&&c!=="preview"&&c!=="search"&&c!=="fullscreen"&&c!=="info"){i.focus()}return false});return this},createDialog:function(a){return $.proxy(E.createDialog,this)(a)},createInfoDialog:function(){var a=this;var b=this.editor;var c=this.classPrefix;var d=["<div class=\""+c+"dialog "+c+"dialog-info\" style=\"\">","<div class=\""+c+"dialog-container\">","<h1><i class=\"editormd-logo editormd-logo-lg editormd-logo-color\"></i> "+E.title+"<small>v"+E.version+"</small></h1>","<p>"+this.lang.description+"</p>","<p style=\"margin: 10px 0 20px 0;\"><a href=\""+E.homePage+"\" target=\"_blank\">"+E.homePage+" <i class=\"fa fa-external-link\"></i></a></p>","<p style=\"font-size: 0.85em;\">Copyright &copy; 2015 <a href=\"https://github.com/pandao\" target=\"_blank\" class=\"hover-link\">Pandao</a>, The <a href=\"https://github.com/pandao/editor.md/blob/master/LICENSE\" target=\"_blank\" class=\"hover-link\">MIT</a> License.</p>","</div>","<a href=\"javascript:;\" class=\"fa fa-close "+c+"dialog-close\"></a>","</div>"].join("\n");b.append(d);var e=this.infoDialog=b.children("."+c+"dialog-info");e.find("."+c+"dialog-close").bind(E.mouseOrTouch("click","touchend"),function(){a.hideInfoDialog()});e.css("border",(E.isIE8)?"1px solid #ddd":"").css("z-index",E.dialogZindex).show();this.infoDialogPosition();return this},infoDialogPosition:function(){var a=this.infoDialog;var b=function(){a.css({top:($(window).height()-a.height())/2+"px",left:($(window).width()-a.width())/2+"px"})};b();$(window).resize(b);return this},showInfoDialog:function(){$("html,body").css("overflow-x","hidden");var a=this;var b=this.editor;var c=this.settings;var d=this.infoDialog=b.children("."+this.classPrefix+"dialog-info");if(d.length<1){this.createInfoDialog()}this.lockScreen(true);this.mask.css({opacity:c.dialogMaskOpacity,backgroundColor:c.dialogMaskBgColor}).show();d.css("z-index",E.dialogZindex).show();this.infoDialogPosition();return this},hideInfoDialog:function(){$("html,body").css("overflow-x","");this.infoDialog.hide();this.mask.hide();this.lockScreen(false);return this},lockScreen:function(a){E.lockScreen(a);this.resize();return this},recreate:function(){var a=this;var b=this.editor;var c=this.settings;this.codeMirror.remove();this.setCodeMirror();if(!c.readOnly){if(b.find(".editormd-dialog").length>0){b.find(".editormd-dialog").remove()}if(c.toolbar){this.getToolbarHandles();this.setToolbar()}}this.loadedDisplay(true);return this},previewCodeHighlight:function(){var a=this.settings;var b=this.previewContainer;if(a.previewCodeHighlight){b.find("pre").addClass("prettyprint linenums");if(typeof prettyPrint!=="undefined"){prettyPrint()}}return this},katexRender:function(){if(F===null){return this}this.previewContainer.find("."+E.classNames.tex).each(function(){var a=$(this);E.$katex.render(a.text(),a[0]);a.find(".katex").css("font-size","1.6em")});return this},flowChartAndSequenceDiagramRender:function(){var a=this;var b=this.settings;var c=this.previewContainer;if(E.isIE8){return this}if(b.flowChart){if(flowchartTimer===null){return this}c.find(".flowchart").flowChart()}if(b.sequenceDiagram){c.find(".sequence-diagram").sequenceDiagram({theme:"simple"})}var d=a.preview;var e=a.codeMirror;var f=e.find(".CodeMirror-scroll");var g=f.height();var h=f.scrollTop();var i=(h/f[0].scrollHeight);var j=0;d.find(".markdown-toc-list").each(function(){j+=$(this).height()});var k=d.find(".editormd-toc-menu").height();k=(!k)?0:k;if(h===0){d.scrollTop(0)}else if(h+g>=f[0].scrollHeight-16){d.scrollTop(d[0].scrollHeight)}else{d.scrollTop((d[0].scrollHeight+j+k)*i)}return this},registerKeyMaps:function(c){var d=this;var e=this.cm;var f=this.settings;var g=E.toolbarHandlers;var h=f.disabledKeyMaps;c=c||null;if(c){for(var i in c){if($.inArray(i,h)<0){var j={};j[i]=c[i];e.addKeyMap(c)}}}else{for(var k in E.keyMaps){var l=E.keyMaps[k];var m=(typeof l==="string")?$.proxy(g[l],d):$.proxy(l,d);if($.inArray(k,["F9","F10","F11"])<0&&$.inArray(k,h)<0){var n={};n[k]=m;e.addKeyMap(n)}}$(window).keydown(function(a){var b={"120":"F9","121":"F10","122":"F11"};if($.inArray(b[a.keyCode],h)<0){switch(a.keyCode){case 120:$.proxy(g["watch"],d)();return false;break;case 121:$.proxy(g["preview"],d)();return false;break;case 122:$.proxy(g["fullscreen"],d)();return false;break;default:break}}})}return this},bindScrollEvent:function(){var g=this;var h=this.preview;var i=this.settings;var j=this.codeMirror;var k=E.mouseOrTouch;if(!i.syncScrolling){return this}var l=function(){j.find(".CodeMirror-scroll").bind(k("scroll","touchmove"),function(a){var b=$(this).height();var c=$(this).scrollTop();var d=(c/$(this)[0].scrollHeight);var e=0;h.find(".markdown-toc-list").each(function(){e+=$(this).height()});var f=h.find(".editormd-toc-menu").height();f=(!f)?0:f;if(c===0){h.scrollTop(0)}else if(c+b>=$(this)[0].scrollHeight-16){h.scrollTop(h[0].scrollHeight)}else{h.scrollTop((h[0].scrollHeight+e+f)*d)}$.proxy(i.onscroll,g)(a)})};var m=function(){j.find(".CodeMirror-scroll").unbind(k("scroll","touchmove"))};var n=function(){h.bind(k("scroll","touchmove"),function(a){var b=$(this).height();var c=$(this).scrollTop();var d=(c/$(this)[0].scrollHeight);var e=j.find(".CodeMirror-scroll");if(c===0){e.scrollTop(0)}else if(c+b>=$(this)[0].scrollHeight){e.scrollTop(e[0].scrollHeight)}else{e.scrollTop(e[0].scrollHeight*d)}$.proxy(i.onpreviewscroll,g)(a)})};var o=function(){h.unbind(k("scroll","touchmove"))};j.bind({mouseover:l,mouseout:m,touchstart:l,touchend:m});if(i.syncScrolling==="single"){return this}h.bind({mouseover:n,mouseout:o,touchstart:n,touchend:o});return this},bindChangeEvent:function(){var c=this;var d=this.cm;var e=this.settings;if(!e.syncScrolling){return this}d.on("change",function(a,b){if(e.watch){c.previewContainer.css("padding",e.autoHeight?"20px 20px 50px 40px":"20px")}F=setTimeout(function(){clearTimeout(F);c.save();F=null},e.delay)});return this},loadedDisplay:function(a){a=a||false;var b=this;var c=this.editor;var d=this.preview;var e=this.settings;this.containerMask.hide();this.save();if(e.watch){d.show()}c.data("oldWidth",c.width()).data("oldHeight",c.height());this.resize();this.registerKeyMaps();$(window).resize(function(){b.resize()});this.bindScrollEvent().bindChangeEvent();if(!a){$.proxy(e.onload,this)()}this.state.loaded=true;return this},width:function(a){this.editor.css("width",(typeof a==="number")?a+"px":a);this.resize();return this},height:function(a){this.editor.css("height",(typeof a==="number")?a+"px":a);this.resize();return this},resize:function(a,b){a=a||null;b=b||null;var c=this.state;var d=this.editor;var e=this.preview;var f=this.toolbar;var g=this.settings;var h=this.codeMirror;if(a){d.css("width",(typeof a==="number")?a+"px":a)}if(g.autoHeight&&!c.fullscreen&&!c.preview){d.css("height","auto");h.css("height","auto")}else{if(b){d.css("height",(typeof b==="number")?b+"px":b)}if(c.fullscreen){d.height($(window).height())}if(g.toolbar&&!g.readOnly){h.css("margin-top",f.height()+1).height(d.height()-f.height())}else{h.css("margin-top",0).height(d.height())}}if(g.watch){h.width(d.width()/2);e.width((!c.preview)?d.width()/2:d.width());this.previewContainer.css("padding",g.autoHeight?"20px 20px 50px 40px":"20px");if(g.toolbar&&!g.readOnly){e.css("top",f.height()+1)}else{e.css("top",0)}if(g.autoHeight&&!c.fullscreen&&!c.preview){e.height("")}else{var i=(g.toolbar&&!g.readOnly)?d.height()-f.height():d.height();e.height(i)}}else{h.width(d.width());e.hide()}if(c.loaded){$.proxy(g.onresize,this)()}return this},save:function(){if(F===null){return this}var a=this;var b=this.state;var c=this.settings;var d=this.cm;var e=d.getValue();var f=this.previewContainer;if(c.mode!=="gfm"&&c.mode!=="markdown"){this.markdownTextarea.val(e);return this}var g=E.$marked;var h=this.markdownToC=[];var i=this.markedRendererOptions={toc:c.toc,tocm:c.tocm,tocStartLevel:c.tocStartLevel,pageBreak:c.pageBreak,taskList:c.taskList,emoji:c.emoji,tex:c.tex,atLink:c.atLink,emailLink:c.emailLink,flowChart:c.flowChart,sequenceDiagram:c.sequenceDiagram,previewCodeHighlight:c.previewCodeHighlight,};var j=this.markedOptions={renderer:E.markedRenderer(h,i),gfm:true,tables:true,breaks:true,pedantic:false,sanitize:(c.htmlDecode)?false:true,smartLists:true,smartypants:true};g.setOptions(j);var k=E.$marked(e,j);k=E.filterHTMLTags(k,c.htmlDecode);this.markdownTextarea.text(e);d.save();if(c.saveHTMLToTextarea){this.htmlTextarea.text(k)}if(c.watch||(!c.watch&&b.preview)){f.html(k);this.previewCodeHighlight();if(c.toc){var l=(c.tocContainer==="")?f:$(c.tocContainer);var m=l.find("."+this.classPrefix+"toc-menu");l.attr("previewContainer",(c.tocContainer==="")?"true":"false");if(c.tocContainer!==""&&m.length>0){m.remove()}E.markdownToCRenderer(h,l,c.tocDropdown,c.tocStartLevel);if(c.tocDropdown||l.find("."+this.classPrefix+"toc-menu").length>0){E.tocDropdownMenu(l,(c.tocTitle!=="")?c.tocTitle:this.lang.tocTitle)}if(c.tocContainer!==""){f.find(".markdown-toc").css("border","none")}}if(c.tex){if(!E.kaTeXLoaded&&c.autoLoadModules){E.loadKaTeX(function(){E.$katex=katex;E.kaTeXLoaded=true;a.katexRender()})}else{E.$katex=katex;this.katexRender()}}if(c.flowChart||c.sequenceDiagram){flowchartTimer=setTimeout(function(){clearTimeout(flowchartTimer);a.flowChartAndSequenceDiagramRender();flowchartTimer=null},10)}if(b.loaded){$.proxy(c.onchange,this)()}}return this},focus:function(){this.cm.focus();return this},setCursor:function(a){this.cm.setCursor(a);return this},getCursor:function(){return this.cm.getCursor()},setSelection:function(a,b){this.cm.setSelection(a,b);return this},getSelection:function(){return this.cm.getSelection()},setSelections:function(a){this.cm.setSelections(a);return this},getSelections:function(){return this.cm.getSelections()},replaceSelection:function(a){this.cm.replaceSelection(a);return this},insertValue:function(a){this.replaceSelection(a);return this},appendMarkdown:function(a){var b=this.settings;var c=this.cm;c.setValue(c.getValue()+a);return this},setMarkdown:function(a){this.cm.setValue(a||this.settings.markdown);return this},getMarkdown:function(){return this.cm.getValue()},getValue:function(){return this.cm.getValue()},setValue:function(a){this.cm.setValue(a);return this},clear:function(){this.cm.setValue("");return this},getHTML:function(){if(!this.settings.saveHTMLToTextarea){alert("Error: settings.saveHTMLToTextarea == false");return false}return this.htmlTextarea.val()},getTextareaSavedHTML:function(){return this.getHTML()},getPreviewedHTML:function(){if(!this.settings.watch){alert("Error: settings.watch == false");return false}return this.previewContainer.html()},watch:function(a){var b=this.settings;if($.inArray(b.mode,["gfm","markdown"])<0){return this}this.state.watching=b.watch=true;this.preview.show();if(this.toolbar){var c=b.toolbarIconsClass.watch;var d=b.toolbarIconsClass.unwatch;var e=this.toolbar.find(".fa[name=watch]");e.parent().attr("title",b.lang.toolbar.watch);e.removeClass(d).addClass(c)}this.codeMirror.css("border-right","1px solid #ddd").width(this.editor.width()/2);F=0;this.save().resize();if(!b.onwatch){b.onwatch=a||function(){}}$.proxy(b.onwatch,this)();return this},unwatch:function(a){var b=this.settings;this.state.watching=b.watch=false;this.preview.hide();if(this.toolbar){var c=b.toolbarIconsClass.watch;var d=b.toolbarIconsClass.unwatch;var e=this.toolbar.find(".fa[name=watch]");e.parent().attr("title",b.lang.toolbar.unwatch);e.removeClass(c).addClass(d)}this.codeMirror.css("border-right","none").width(this.editor.width());this.resize();if(!b.onunwatch){b.onunwatch=a||function(){}}$.proxy(b.onunwatch,this)();return this},show:function(a){a=a||function(){};var b=this;this.editor.show(0,function(){$.proxy(a,b)()});return this},hide:function(a){a=a||function(){};var b=this;this.editor.hide(0,function(){$.proxy(a,b)()});return this},previewing:function(){var b=this;var c=this.editor;var d=this.preview;var e=this.toolbar;var f=this.settings;var g=this.codeMirror;var h=this.previewContainer;if($.inArray(f.mode,["gfm","markdown"])<0){return this}if(f.toolbar&&e){e.toggle();e.find(".fa[name=preview]").toggleClass("active")}g.toggle();var i=function(a){if(a.shiftKey&&a.keyCode===27){b.previewed()}};if(g.css("display")==="none"){this.state.preview=true;if(this.state.fullscreen){d.css("background","#fff")}c.find("."+this.classPrefix+"preview-close-btn").show().bind(E.mouseOrTouch("click","touchend"),function(){b.previewed()});if(!f.watch){this.save()}else{h.css("padding","")}h.addClass(this.classPrefix+"preview-active");d.show().css({position:"",top:0,width:c.width(),height:(f.autoHeight&&!this.state.fullscreen)?"auto":c.height()});if(this.state.loaded){$.proxy(f.onpreviewing,this)()}$(window).bind("keyup",i)}else{$(window).unbind("keyup",i);this.previewed()}},previewed:function(){var a=this.editor;var b=this.preview;var c=this.toolbar;var d=this.settings;var e=this.previewContainer;var f=a.find("."+this.classPrefix+"preview-close-btn");this.state.preview=false;this.codeMirror.show();if(d.toolbar){c.show()}b[(d.watch)?"show":"hide"]();f.hide().unbind(E.mouseOrTouch("click","touchend"));e.removeClass(this.classPrefix+"preview-active");if(d.watch){e.css("padding","20px")}b.css({background:null,position:"absolute",width:a.width()/2,height:(d.autoHeight&&!this.state.fullscreen)?"auto":a.height()-c.height(),top:(d.toolbar)?c.height():0});if(this.state.loaded){$.proxy(d.onpreviewed,this)()}return this},fullscreen:function(){var b=this;var c=this.state;var d=this.editor;var e=this.preview;var f=this.toolbar;var g=this.settings;var h=this.classPrefix+"fullscreen";if(f){f.find(".fa[name=fullscreen]").parent().toggleClass("active")}var i=function(a){if(!a.shiftKey&&a.keyCode===27){if(c.fullscreen){b.fullscreenExit()}}};if(!d.hasClass(h)){c.fullscreen=true;$("html,body").css("overflow","hidden");d.css({width:$(window).width(),height:$(window).height()}).addClass(h);this.resize();$.proxy(g.onfullscreen,this)();$(window).bind("keyup",i)}else{$(window).unbind("keyup",i);this.fullscreenExit()}return this},fullscreenExit:function(){var a=this.editor;var b=this.settings;var c=this.toolbar;var d=this.classPrefix+"fullscreen";this.state.fullscreen=false;if(c){c.find(".fa[name=fullscreen]").parent().removeClass("active")}$("html,body").css("overflow","");a.css({width:a.data("oldWidth"),height:a.data("oldHeight")}).removeClass(d);this.resize();$.proxy(b.onfullscreenExit,this)();return this},executePlugin:function(a,b){var c=this;var d=this.cm;var e=this.settings;b=e.pluginPath+b;if(typeof define==="function"){if(typeof this[a]==="undefined"){alert("Error: "+a+" plugin is not found, you are not load this plugin.");return this}this[a](d);return this}if($.inArray(b,E.loadFiles.plugin)<0){E.loadPlugin(b,function(){E.loadPlugins[a]=c[a];c[a](d)})}else{$.proxy(E.loadPlugins[a],this)(d)}return this},search:function(a){var b=this.settings;if(!b.searchReplace){alert("Error: settings.searchReplace == false");return this}if(!b.readOnly){this.cm.execCommand(a||"find")}return this},searchReplace:function(){this.search("replace");return this},searchReplaceAll:function(){this.search("replaceAll");return this}};E.fn.init.prototype=E.fn;E.dialogLockScreen=function(){var a=this.settings||{dialogLockScreen:true};if(a.dialogLockScreen){$("html,body").css("overflow","hidden");this.resize()}};E.dialogShowMask=function(a){var b=this.editor;var c=this.settings||{dialogShowMask:true};a.css({top:($(window).height()-a.height())/2+"px",left:($(window).width()-a.width())/2+"px"});if(c.dialogShowMask){b.children("."+this.classPrefix+"mask").css("z-index",parseInt(a.css("z-index"))-1).show()}};E.toolbarHandlers={undo:function(){this.cm.undo()},redo:function(){this.cm.redo()},bold:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();a.replaceSelection("**"+c+"**");if(c===""){a.setCursor(b.line,b.ch+2)}},del:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();a.replaceSelection("~~"+c+"~~");if(c===""){a.setCursor(b.line,b.ch+2)}},italic:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();a.replaceSelection("*"+c+"*");if(c===""){a.setCursor(b.line,b.ch+1)}},quote:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(b.ch!==0){a.setCursor(b.line,0);a.replaceSelection("> "+c);a.setCursor(b.line,b.ch+2)}else{a.replaceSelection("> "+c)}},ucfirst:function(){var a=this.cm;var b=a.getSelection();var c=a.listSelections();a.replaceSelection(E.firstUpperCase(b));a.setSelections(c)},ucwords:function(){var a=this.cm;var b=a.getSelection();var c=a.listSelections();a.replaceSelection(E.wordsFirstUpperCase(b));a.setSelections(c)},uppercase:function(){var a=this.cm;var b=a.getSelection();var c=a.listSelections();a.replaceSelection(b.toUpperCase());a.setSelections(c)},lowercase:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();var d=a.listSelections();a.replaceSelection(c.toLowerCase());a.setSelections(d)},h1:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(b.ch!==0){a.setCursor(b.line,0);a.replaceSelection("# "+c);a.setCursor(b.line,b.ch+2)}else{a.replaceSelection("# "+c)}},h2:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(b.ch!==0){a.setCursor(b.line,0);a.replaceSelection("## "+c);a.setCursor(b.line,b.ch+3)}else{a.replaceSelection("## "+c)}},h3:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(b.ch!==0){a.setCursor(b.line,0);a.replaceSelection("### "+c);a.setCursor(b.line,b.ch+4)}else{a.replaceSelection("### "+c)}},h4:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(b.ch!==0){a.setCursor(b.line,0);a.replaceSelection("#### "+c);a.setCursor(b.line,b.ch+5)}else{a.replaceSelection("#### "+c)}},h5:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(b.ch!==0){a.setCursor(b.line,0);a.replaceSelection("##### "+c);a.setCursor(b.line,b.ch+6)}else{a.replaceSelection("##### "+c)}},h6:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(b.ch!==0){a.setCursor(b.line,0);a.replaceSelection("###### "+c);a.setCursor(b.line,b.ch+7)}else{a.replaceSelection("###### "+c)}},"list-ul":function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(c===""){a.replaceSelection("- "+c)}else{var d=c.split("\n");for(var i=0,len=d.length;i<len;i++){d[i]=(d[i]==="")?"":"- "+d[i]}a.replaceSelection(d.join("\n"))}},"list-ol":function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(c===""){a.replaceSelection("1. "+c)}else{var d=c.split("\n");for(var i=0,len=d.length;i<len;i++){d[i]=(d[i]==="")?"":(i+1)+". "+d[i]}a.replaceSelection(d.join("\n"))}},hr:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();a.replaceSelection(((b.ch!==0)?"\n\n":"\n")+"------------\n\n")},tex:function(){if(!this.settings.tex){alert("settings.tex === false");return this}var a=this.cm;var b=a.getCursor();var c=a.getSelection();a.replaceSelection("$$"+c+"$$");if(c===""){a.setCursor(b.line,b.ch+2)}},link:function(){this.executePlugin("linkDialog","link-dialog/link-dialog")},"reference-link":function(){this.executePlugin("referenceLinkDialog","reference-link-dialog/reference-link-dialog")},pagebreak:function(){if(!this.settings.pageBreak){alert("settings.pageBreak === false");return this}var a=this.cm;var b=a.getSelection();a.replaceSelection("\r\n[========]\r\n")},image:function(){this.executePlugin("imageDialog","image-dialog/image-dialog")},code:function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();a.replaceSelection("`"+c+"`");if(c===""){a.setCursor(b.line,b.ch+1)}},"code-block":function(){this.executePlugin("codeBlockDialog","code-block-dialog/code-block-dialog")},"preformatted-text":function(){this.executePlugin("preformattedTextDialog","preformatted-text-dialog/preformatted-text-dialog")},table:function(){this.executePlugin("tableDialog","table-dialog/table-dialog")},datetime:function(){var a=this.cm;var b=a.getSelection();var c=new Date();var d=this.settings.lang.name;var e=E.dateFormat()+" "+E.dateFormat((d==="zh-cn"||d==="zh-tw")?"cn-week-day":"week-day");a.replaceSelection(e)},emoji:function(){this.executePlugin("emojiDialog","emoji-dialog/emoji-dialog")},"html-entities":function(){this.executePlugin("htmlEntitiesDialog","html-entities-dialog/html-entities-dialog")},"goto-line":function(){this.executePlugin("gotoLineDialog","goto-line-dialog/goto-line-dialog")},watch:function(){this[this.settings.watch?"unwatch":"watch"]()},preview:function(){this.previewing()},fullscreen:function(){this.fullscreen()},clear:function(){this.clear()},search:function(){this.search()},help:function(){this.executePlugin("helpDialog","help-dialog/help-dialog")},info:function(){this.showInfoDialog()}};E.keyMaps={"Ctrl-1":"h1","Ctrl-2":"h2","Ctrl-3":"h3","Ctrl-4":"h4","Ctrl-5":"h5","Ctrl-6":"h6","Ctrl-B":"bold","Ctrl-D":"datetime","Ctrl-E":function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(!this.settings.emoji){alert("Error: settings.emoji == false");return}a.replaceSelection(":"+c+":");if(c===""){a.setCursor(b.line,b.ch+1)}},"Ctrl-Alt-G":"goto-line","Ctrl-H":"hr","Ctrl-I":"italic","Ctrl-K":"code","Ctrl-L":function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();var d=(c==="")?"":" \""+c+"\"";a.replaceSelection("["+c+"]("+d+")");if(c===""){a.setCursor(b.line,b.ch+1)}},"Ctrl-U":"list-ul","Shift-Ctrl-A":function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();if(!this.settings.atLink){alert("Error: settings.atLink == false");return}a.replaceSelection("@"+c);if(c===""){a.setCursor(b.line,b.ch+1)}},"Shift-Ctrl-C":"code","Shift-Ctrl-Q":"quote","Shift-Ctrl-S":"del","Shift-Ctrl-K":"tex","Shift-Alt-C":function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();a.replaceSelection(["```",c,"```"].join("\n"));if(c===""){a.setCursor(b.line,b.ch+3)}},"Shift-Ctrl-Alt-C":"code-block","Shift-Ctrl-H":"html-entities","Shift-Alt-H":"help","Shift-Ctrl-E":"emoji","Shift-Ctrl-U":"uppercase","Shift-Alt-U":"ucwords","Shift-Ctrl-Alt-U":"ucfirst","Shift-Alt-L":"lowercase","Shift-Ctrl-I":function(){var a=this.cm;var b=a.getCursor();var c=a.getSelection();var d=(c==="")?"":" \""+c+"\"";a.replaceSelection("!["+c+"]("+d+")");if(c===""){a.setCursor(b.line,b.ch+4)}},"Shift-Ctrl-Alt-I":"image","Shift-Ctrl-L":"link","Shift-Ctrl-O":"list-ol","Shift-Ctrl-P":"preformatted-text","Shift-Ctrl-T":"table","Shift-Alt-P":"pagebreak","F9":"watch","F10":"preview","F11":"fullscreen",};var G=function(a){return(!String.prototype.trim)?a.replace(/^[\s﻿ ]+|[\s﻿ ]+$/g,""):a.trim()};E.trim=G;var H=function(b){return b.toLowerCase().replace(/\b(\w)|\s(\w)/g,function(a){return a.toUpperCase()})};E.ucwords=E.wordsFirstUpperCase=H;var I=function(b){return b.toLowerCase().replace(/\b(\w)/,function(a){return a.toUpperCase()})};var J=I;E.firstUpperCase=E.ucfirst=I;E.urls={atLinkBase:"https://github.com/"};E.regexs={atLink:/@(\w+)/g,email:/(\w+)@(\w+)\.(\w+)\.?(\w+)?/g,emailLink:/(mailto:)?([\w\.\_]+)@(\w+)\.(\w+)\.?(\w+)?/g,emoji:/:([\w\+-]+):/g,emojiDatetime:/(\d{2}:\d{2}:\d{2})/g,twemoji:/:(tw-([\w]+)-?(\w+)?):/g,fontAwesome:/:(fa-([\w]+)(-(\w+)){0,}):/g,editormdLogo:/:(editormd-logo-?(\w+)?):/g,pageBreak:/^\[[=]{8,}\]$/};E.emoji={path:"http://www.emoji-cheat-sheet.com/graphics/emojis/",ext:".png"};E.twemoji={path:"http://twemoji.maxcdn.com/36x36/",ext:".png"};E.markedRenderer=function(n,o){var p={toc:true,tocm:false,tocStartLevel:1,pageBreak:true,atLink:true,emailLink:true,taskList:false,emoji:false,tex:false,flowChart:false,sequenceDiagram:false,};var q=$.extend(p,o||{});var r=E.$marked;var s=new r.Renderer();n=n||[];var u=E.regexs;var v=u.atLink;var w=u.emoji;var y=u.email;var z=u.emailLink;var A=u.twemoji;var B=u.fontAwesome;var C=u.editormdLogo;var D=u.pageBreak;s.emoji=function(l){l=l.replace(E.regexs.emojiDatetime,function(a){return a.replace(/:/g,"&#58;")});var m=l.match(w);if(!m||!q.emoji){return l}for(var i=0,len=m.length;i<len;i++){if(m[i]===":+1:"){m[i]=":\\+1:"}l=l.replace(new RegExp(m[i]),function(a,b){var c=a.match(B);var d=a.replace(/:/g,"");if(c){for(var e=0,len1=c.length;e<len1;e++){var f=c[e].replace(/:/g,"");return"<i class=\"fa "+f+" fa-emoji\" title=\""+f.replace("fa-","")+"\"></i>"}}else{var g=a.match(C);var h=a.match(A);if(g){for(var x=0,len2=g.length;x<len2;x++){var i=g[x].replace(/:/g,"");return"<i class=\""+i+"\" title=\"Editor.md logo ("+i+")\"></i>"}}else if(h){for(var t=0,len3=h.length;t<len3;t++){var j=h[t].replace(/:/g,"").replace("tw-","");return"<img src=\""+E.twemoji.path+j+E.twemoji.ext+"\" title=\"twemoji-"+j+"\" alt=\"twemoji-"+j+"\" class=\"emoji twemoji\" />"}}else{var k=(d==="+1")?"plus1":d;k=(k==="black_large_square")?"black_square":k;k=(k==="moon")?"waxing_gibbous_moon":k;return"<img src=\""+E.emoji.path+k+E.emoji.ext+"\" class=\"emoji\" title=\"&#58;"+d+"&#58;\" alt=\"&#58;"+d+"&#58;\" />"}}})}return l};s.atLink=function(f){if(v.test(f)){if(q.atLink){f=f.replace(y,function(a,b,c,d){return a.replace(/@/g,"_#_&#64;_#_")});f=f.replace(v,function(a,b){return"<a href=\""+E.urls.atLinkBase+""+b+"\" title=\"&#64;"+b+"\" class=\"at-link\">"+a+"</a>"}).replace(/_#_&#64;_#_/g,"@")}if(q.emailLink){f=f.replace(z,function(a,b,c,d,e){return(!b&&$.inArray(e,"jpg|jpeg|png|gif|webp|ico|icon|pdf".split("|"))<0)?"<a href=\"mailto:"+a+"\">"+a+"</a>":a})}return f}return f};s.link=function(a,b,c){if(this.options.sanitize){try{var d=decodeURIComponent(unescape(a)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return""}if(d.indexOf("javascript:")===0){return""}}var f="<a href=\""+a+"\"";if(v.test(b)||v.test(c)){if(b){f+=" title=\""+b.replace(/@/g,"&#64;")}return f+"\">"+c.replace(/@/g,"&#64;")+"</a>"}if(b){f+=" title=\""+b+"\""}f+=">"+c+"</a>";return f};s.heading=function(a,b,c){var d=a;var e=/\s*\<a\s*href\=\"(.*)\"\s*([^\>]*)\>(.*)\<\/a\>\s*/;var f=/\s*\<a\s*([^\>]+)\>([^\>]*)\<\/a\>\s*/g;if(e.test(a)){var g=[];a=a.split(/\<a\s*([^\>]+)\>([^\>]*)\<\/a\>/);for(var i=0,len=a.length;i<len;i++){g.push(a[i].replace(/\s*href\=\"(.*)\"\s*/g,""))}a=g.join(" ")}a=G(a);var h=a.toLowerCase().replace(/[^\w]+/g,"-");var j={text:a,level:b,slug:h};var k=/^[一-龥]+$/.test(a);var l=(k)?escape(a).replace(/\%/g,""):a.toLowerCase().replace(/[^\w]+/g,"-");n.push(j);var m="<h"+b+" id=\"h"+b+"-"+this.options.headerPrefix+l+"\">";m+="<a name=\""+a+"\" class=\"reference-link\"></a>";m+="<span class=\"header-link octicon octicon-link\"></span>";m+=(e)?this.atLink(this.emoji(d)):this.atLink(this.emoji(a));m+="</h"+b+">";return m};s.pageBreak=function(a){if(D.test(a)&&q.pageBreak){a="<hr style=\"page-break-after:always;\" class=\"page-break editormd-page-break\" />"}return a};s.paragraph=function(c){var d=/\$\$(.*)\$\$/g.test(c);var e=/^\$\$(.*)\$\$$/.test(c);var f=(e)?" class=\""+E.classNames.tex+"\"":"";var g=(q.tocm)?/^(\[TOC\]|\[TOCM\])$/.test(c):/^\[TOC\]$/.test(c);var h=/^\[TOCM\]$/.test(c);if(!e&&d){c=c.replace(/(\$\$([^\$]*)\$\$)+/g,function(a,b){return"<span class=\""+E.classNames.tex+"\">"+b.replace(/\$/g,"")+"</span>"})}else{c=(e)?c.replace(/\$/g,""):c}var i="<div class=\"markdown-toc editormd-markdown-toc\">"+c+"</div>";return(g)?((h)?"<div class=\"editormd-toc-menu\">"+i+"</div><br/>":i):((D.test(c))?this.pageBreak(c):"<p"+f+">"+this.atLink(this.emoji(c))+"</p>\n")};s.code=function(a,b,c){if(b==="seq"||b==="sequence"){return"<div class=\"sequence-diagram\">"+a+"</div>"}else if(b==="flow"){return"<div class=\"flowchart\">"+a+"</div>"}else if(b==="math"||b==="latex"||b==="katex"){return"<p class=\""+E.classNames.tex+"\">"+a+"</p>"}else{return r.Renderer.prototype.code.apply(this,arguments)}};s.tablecell=function(a,b){var c=(b.header)?"th":"td";var d=(b.align)?"<"+c+" style=\"text-align:"+b.align+"\">":"<"+c+">";return d+this.atLink(this.emoji(a))+"</"+c+">\n"};s.listitem=function(a){if(q.taskList&&/^\s*\[[x\s]\]\s*/.test(a)){a=a.replace(/^\s*\[\s\]\s*/,"<input type=\"checkbox\" class=\"task-list-item-checkbox\" /> ").replace(/^\s*\[x\]\s*/,"<input type=\"checkbox\" class=\"task-list-item-checkbox\" checked disabled /> ");return"<li style=\"list-style: none;\">"+this.atLink(this.emoji(a))+"</li>"}else{return"<li>"+this.atLink(this.emoji(a))+"</li>"}};return s};E.markdownToCRenderer=function(a,b,c,d){var e="";var f=0;var g=this.classPrefix;d=d||1;for(var i=0,len=a.length;i<len;i++){var h=a[i].text;var j=a[i].level;if(j<d){continue}if(j>f){e+=""}else if(j<f){e+=(new Array(f-j+2)).join("</ul></li>")}else{e+="</ul></li>"}e+="<li><a class=\"toc-level-"+j+"\" href=\"#"+h+"\" level=\""+j+"\">"+h+"</a><ul>";f=j}var k=b.find(".markdown-toc");if((k.length<1&&b.attr("previewContainer")==="false")){var l="<div class=\"markdown-toc "+g+"markdown-toc\"></div>";l=(c)?"<div class=\""+g+"toc-menu\">"+l+"</div>":l;b.html(l);k=b.find(".markdown-toc")}if(c){k.wrap("<div class=\""+g+"toc-menu\"></div><br/>")}k.html("<ul class=\"markdown-toc-list\"></ul>").children(".markdown-toc-list").html(e.replace(/\r?\n?\<ul\>\<\/ul\>/g,""));return k};E.tocDropdownMenu=function(j,k){k=k||"Table of Contents";var l=400;var m=j.find("."+this.classPrefix+"toc-menu");m.each(function(){var d=$(this);var e=d.children(".markdown-toc");var f="<i class=\"fa fa-angle-down\"></i>";var g="<a href=\"javascript:;\" class=\"toc-menu-btn\">"+f+k+"</a>";var h=e.children("ul");var i=h.find("li");e.append(g);i.first().before("<li><h1>"+k+" "+f+"</h1></li>");d.mouseover(function(){h.show();i.each(function(){var a=$(this);var b=a.children("ul");if(b.html()===""){b.remove()}if(b.length>0&&b.html()!==""){var c=a.children("a").first();if(c.children(".fa").length<1){c.append($(f).css({float:"right",paddingTop:"4px"}))}}a.mouseover(function(){b.css("z-index",l).show();l+=1}).mouseleave(function(){b.hide()})})}).mouseleave(function(){h.hide()})});return m};E.filterHTMLTags=function(l,m){if(typeof l!=="string"){l=new String(l)}if(typeof m!=="string"){return l}var n=m.split("|");var o=n[0].split(",");var p=n[1];for(var i=0,len=o.length;i<len;i++){var q=o[i];l=l.replace(new RegExp("\<\s*"+q+"\s*([^\>]*)\>([^\>]*)\<\s*\/"+q+"\s*\>","igm"),"")}if(typeof p!=="undefined"){var r=/\<(\w+)\s*([^\>]*)\>([^\>]*)\<\/(\w+)\>/ig;if(p==="*"){l=l.replace(r,function(a,b,c,d,e){return"<"+b+">"+d+"</"+e+">"})}else if(p==="on*"){l=l.replace(r,function(a,b,c,d,f){var g=$("<"+b+">"+d+"</"+f+">");var h=$(a)[0].attributes;var j={};$.each(h,function(i,e){if(e.nodeName!=='"')j[e.nodeName]=e.nodeValue});$.each(j,function(i){if(i.indexOf("on")===0){delete j[i]}});g.attr(j);var k=(typeof g[1]!=="undefined")?$(g[1]).text():"";return g[0].outerHTML+k})}else{l=l.replace(r,function(a,b,c,d){var e=p.split(",");var f=$(a);f.html(d);$.each(e,function(i){f.attr(e[i],null)});return f[0].outerHTML})}}return l};E.markdownToHTML=function(b,c){var d={gfm:true,toc:true,tocm:false,tocStartLevel:1,tocTitle:"目录",tocDropdown:false,tocContainer:"",markdown:"",markdownSourceCode:false,htmlDecode:false,autoLoadKaTeX:true,pageBreak:true,atLink:true,emailLink:true,tex:false,taskList:false,emoji:false,flowChart:false,sequenceDiagram:false,previewCodeHighlight:true};E.$marked=marked;var e=$("#"+b);var f=e.settings=$.extend(true,d,c||{});var g=e.find("textarea");if(g.length<1){e.append("<textarea></textarea>");g=e.find("textarea")}var h=(f.markdown==="")?g.val():f.markdown;var i=[];var j={toc:f.toc,tocm:f.tocm,tocStartLevel:f.tocStartLevel,taskList:f.taskList,emoji:f.emoji,tex:f.tex,pageBreak:f.pageBreak,atLink:f.atLink,emailLink:f.emailLink,flowChart:f.flowChart,sequenceDiagram:f.sequenceDiagram,previewCodeHighlight:f.previewCodeHighlight,};var k={renderer:E.markedRenderer(i,j),gfm:f.gfm,tables:true,breaks:true,pedantic:false,sanitize:(f.htmlDecode)?false:true,smartLists:true,smartypants:true};h=new String(h);var l=marked(h,k);l=E.filterHTMLTags(l,f.htmlDecode);if(f.markdownSourceCode){g.text(h)}else{g.remove()}e.addClass("markdown-body "+this.classPrefix+"html-preview").append(l);var m=(f.tocContainer!=="")?$(f.tocContainer):e;if(f.tocContainer!==""){m.attr("previewContainer",false)}if(f.toc){e.tocContainer=this.markdownToCRenderer(i,m,f.tocDropdown,f.tocStartLevel);if(f.tocDropdown||e.find("."+this.classPrefix+"toc-menu").length>0){this.tocDropdownMenu(e,f.tocTitle)}if(f.tocContainer!==""){e.find(".editormd-toc-menu, .editormd-markdown-toc").remove()}}if(f.previewCodeHighlight){e.find("pre").addClass("prettyprint linenums");prettyPrint()}if(!E.isIE8){if(f.flowChart){e.find(".flowchart").flowChart()}if(f.sequenceDiagram){e.find(".sequence-diagram").sequenceDiagram({theme:"simple"})}}if(f.tex){var n=function(){e.find("."+E.classNames.tex).each(function(){var a=$(this);katex.render(a.html().replace(/&lt;/g,"<").replace(/&gt;/g,">"),a[0]);a.find(".katex").css("font-size","1.6em")})};if(f.autoLoadKaTeX&&!E.$katex&&!E.kaTeXLoaded){this.loadKaTeX(function(){E.$katex=katex;E.kaTeXLoaded=true;n()})}else{n()}}e.getMarkdown=function(){return g.val()};return e};E.themes=["default","dark"];E.previewThemes=["default","dark"];E.editorThemes=["default","3024-day","3024-night","ambiance","ambiance-mobile","base16-dark","base16-light","blackboard","cobalt","eclipse","elegant","erlang-dark","lesser-dark","mbo","mdn-like","midnight","monokai","neat","neo","night","paraiso-dark","paraiso-light","pastel-on-dark","rubyblue","solarized","the-matrix","tomorrow-night-eighties","twilight","vibrant-ink","xq-dark","xq-light"];E.loadPlugins={};E.loadFiles={js:[],css:[],plugin:[]};E.loadPlugin=function(a,b,c){b=b||function(){};if(E.loadFiles.plugin.indexOf(a)!==-1){return b()}this.loadScript(a,function(){E.loadFiles.plugin.push(a);b()},c)};E.loadCSS=function(a,b,c){c=c||"head";b=b||function(){};if(E.loadFiles.css.indexOf(a)!==-1){return b()}var d=document.createElement("link");d.type="text/css";d.rel="stylesheet";d.onload=d.onreadystatechange=function(){E.loadFiles.css.push(a);b()};d.href=a+".css";if(c==="head"){document.getElementsByTagName("head")[0].appendChild(d)}else{document.body.appendChild(d)}};E.isIE=(navigator.appName=="Microsoft Internet Explorer");E.isIE8=(E.isIE&&navigator.appVersion.match(/8./i)=="8.");E.loadScript=function(a,b,c){c=c||"head";b=b||function(){};if(E.loadFiles.js.indexOf(a)!==-1){return b()}var d=null;d=document.createElement("script");d.id=a.replace(/[\./]+/g,"-");d.type="text/javascript";d.src=a+".js";if(E.isIE8){d.onreadystatechange=function(){if(d.readyState){if(d.readyState==="loaded"||d.readyState==="complete"){d.onreadystatechange=null;E.loadFiles.js.push(a);b()}}}}else{d.onload=function(){E.loadFiles.js.push(a);b()}}if(c==="head"){document.getElementsByTagName("head")[0].appendChild(d)}else{document.body.appendChild(d)}};E.katexURL={css:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min",js:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min"};E.kaTeXLoaded=false;E.loadKaTeX=function(a){E.loadCSS(E.katexURL.css,function(){E.loadScript(E.katexURL.js,a||function(){})})};E.lockScreen=function(a){$("html,body").css("overflow",(a)?"hidden":"")};E.createDialog=function(g){var h={name:"",width:420,height:240,title:"",drag:true,closed:true,content:"",mask:true,maskStyle:{backgroundColor:"#fff",opacity:0.1},lockScreen:true,footer:true,buttons:false};g=$.extend(true,h,g);var i=this;var j=this.editor;var k=E.classPrefix;var l=(new Date()).getTime();var m=((g.name==="")?k+"dialog-"+l:g.name);var n=E.mouseOrTouch;var o="<div class=\""+k+"dialog "+m+"\">";if(g.title!==""){o+="<div class=\""+k+"dialog-header\""+((g.drag)?" style=\"cursor: move;\"":"")+">";o+="<strong class=\""+k+"dialog-title\">"+g.title+"</strong>";o+="</div>"}if(g.closed){o+="<a href=\"javascript:;\" class=\"fa fa-close "+k+"dialog-close\"></a>"}o+="<div class=\""+k+"dialog-container\">"+g.content;if(g.footer||typeof g.footer==="string"){o+="<div class=\""+k+"dialog-footer\">"+((typeof g.footer==="boolean")?"":g.footer)+"</div>"}o+="</div>";o+="<div class=\""+k+"dialog-mask "+k+"dialog-mask-bg\"></div>";o+="<div class=\""+k+"dialog-mask "+k+"dialog-mask-con\"></div>";o+="</div>";j.append(o);var p=j.find("."+m);p.lockScreen=function(a){if(g.lockScreen){$("html,body").css("overflow",(a)?"hidden":"");i.resize()}return p};p.showMask=function(){if(g.mask){j.find("."+k+"mask").css(g.maskStyle).css("z-index",E.dialogZindex-1).show()}return p};p.hideMask=function(){if(g.mask){j.find("."+k+"mask").hide()}return p};p.loading=function(a){var b=p.find("."+k+"dialog-mask");b[(a)?"show":"hide"]();return p};p.lockScreen(true).showMask();p.show().css({zIndex:E.dialogZindex,border:(E.isIE8)?"1px solid #ddd":"",width:(typeof g.width==="number")?g.width+"px":g.width,height:(typeof g.height==="number")?g.height+"px":g.height});var q=function(){p.css({top:($(window).height()-p.height())/2+"px",left:($(window).width()-p.width())/2+"px"})};q();$(window).resize(q);p.children("."+k+"dialog-close").bind(n("click","touchend"),function(){p.hide().lockScreen(false).hideMask()});if(typeof g.buttons==="object"){var r=p.footer=p.find("."+k+"dialog-footer");for(var s in g.buttons){var t=g.buttons[s];var u=k+s+"-btn";r.append("<button class=\""+k+"btn "+u+"\">"+t[0]+"</button>");t[1]=$.proxy(t[1],p);r.children("."+u).bind(n("click","touchend"),t[1])}}if(g.title!==""&&g.drag){var v,posY;var w=p.children("."+k+"dialog-header");if(!g.mask){w.bind(n("click","touchend"),function(){E.dialogZindex+=2;p.css("z-index",E.dialogZindex)})}w.mousedown(function(e){e=e||window.event;v=e.clientX-parseInt(p[0].style.left);posY=e.clientY-parseInt(p[0].style.top);document.onmousemove=z});var x=function(a){a.removeClass(k+"user-unselect").off("selectstart")};var y=function(b){b.addClass(k+"user-unselect").on("selectstart",function(a){return false})};var z=function(e){e=e||window.event;var a,top,nowLeft=parseInt(p[0].style.left),nowTop=parseInt(p[0].style.top);if(nowLeft>=0){if(nowLeft+p.width()<=$(window).width()){a=e.clientX-v}else{a=$(window).width()-p.width();document.onmousemove=null}}else{a=0;document.onmousemove=null}if(nowTop>=0){top=e.clientY-posY}else{top=0;document.onmousemove=null}document.onselectstart=function(){return false};y($("body"));y(p);p[0].style.left=a+"px";p[0].style.top=top+"px"};document.onmouseup=function(){x($("body"));x(p);document.onselectstart=null;document.onmousemove=null};w.touchDraggable=function(){var c=null;var d=function(e){var a=e.originalEvent;var b=$(this).parent().position();c={x:a.changedTouches[0].pageX-b.left,y:a.changedTouches[0].pageY-b.top}};var f=function(e){e.preventDefault();var a=e.originalEvent;$(this).parent().css({top:a.changedTouches[0].pageY-c.y,left:a.changedTouches[0].pageX-c.x})};this.bind("touchstart",d).bind("touchmove",f)};w.touchDraggable()}E.dialogZindex+=2;return p};E.mouseOrTouch=function(a,b){a=a||"click";b=b||"touchend";var c=a;try{document.createEvent("TouchEvent");c=b}catch(e){}return c};E.dateFormat=function(a){a=a||"";var b=function(d){return(d<10)?"0"+d:d};var c=new Date();var e=c.getFullYear();var f=e.toString().slice(2,4);var g=b(c.getMonth()+1);var h=b(c.getDate());var i=c.getDay();var j=b(c.getHours());var k=b(c.getMinutes());var l=b(c.getSeconds());var m=b(c.getMilliseconds());var n="";var o=f+"-"+g+"-"+h;var p=e+"-"+g+"-"+h;var q=j+":"+k+":"+l;switch(a){case"UNIX Time":n=c.getTime();break;case"UTC":n=c.toUTCString();break;case"yy":n=f;break;case"year":case"yyyy":n=e;break;case"month":case"mm":n=g;break;case"cn-week-day":case"cn-wd":var r=["日","一","二","三","四","五","六"];n="星期"+r[i];break;case"week-day":case"wd":var s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];n=s[i];break;case"day":case"dd":n=h;break;case"hour":case"hh":n=j;break;case"min":case"ii":n=k;break;case"second":case"ss":n=l;break;case"ms":n=m;break;case"yy-mm-dd":n=o;break;case"yyyy-mm-dd":n=p;break;case"yyyy-mm-dd h:i:s ms":case"full + ms":n=p+" "+q+" "+m;break;case"full":case"yyyy-mm-dd h:i:s":default:n=p+" "+q;break}return n};return E}));